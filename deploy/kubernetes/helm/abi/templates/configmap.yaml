apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "abi.configmapName" . }}
  labels:
    {{- include "abi.labels" . | nindent 4 }}
data:
  # Application settings
  ABBEY_LOG_LEVEL: {{ .Values.config.logLevel | quote }}
  ABBEY_LOG_FORMAT: {{ .Values.config.logFormat | quote }}
  ABBEY_HOST: {{ .Values.config.host | quote }}
  ABBEY_PORT: {{ .Values.config.port | quote }}
  ABBEY_METRICS_PORT: {{ .Values.config.metricsPort | quote }}
  ABBEY_DATA_DIR: {{ .Values.config.dataDir | quote }}

  # Feature flags
  ABI_ENABLE_AI: {{ .Values.features.ai | quote }}
  ABI_ENABLE_GPU: {{ .Values.features.gpu | quote }}
  ABI_ENABLE_DATABASE: {{ .Values.features.database | quote }}
  ABI_ENABLE_NETWORK: {{ .Values.features.network | quote }}
  ABI_ENABLE_WEB: {{ .Values.features.web | quote }}
  ABI_ENABLE_PROFILING: {{ .Values.features.profiling | quote }}

  {{- if .Values.features.gpu }}
  # GPU settings
  ABI_GPU_BACKEND: {{ .Values.gpu.backend | quote }}
  {{- end }}

  # Tracing
  ABBEY_ENABLE_TRACING: {{ .Values.tracing.enabled | quote }}
  {{- if .Values.tracing.jaegerEndpoint }}
  ABBEY_JAEGER_ENDPOINT: {{ .Values.tracing.jaegerEndpoint | quote }}
  {{- end }}

  # LLM configuration
  ABI_LLM_PROVIDER: {{ .Values.llm.provider | quote }}
  {{- if eq .Values.llm.provider "ollama" }}
  ABI_OLLAMA_HOST: {{ .Values.llm.ollama.host | quote }}
  ABI_OLLAMA_MODEL: {{ .Values.llm.ollama.model | quote }}
  {{- end }}
