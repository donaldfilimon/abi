<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>database - ABI Framework Documentation</title>
  <meta name="description" content="">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/abi/assets/css/style.css">
</head>
<body>
<nav class="navbar">
  <div class="nav-container">
    <a href="/abi/" class="nav-logo">
      <span class="logo-text">ABI</span>
      <span class="logo-version">v0.16.0</span>
    </a>
    <div class="nav-links">
      <a href="/abi/">Home</a>
      <a href="/abi/intro.html">Docs</a>
      <a href="https://github.com/donaldfilimon/abi" target="_blank">GitHub</a>
    </div>
    <button class="theme-toggle" onclick="toggleTheme()"><span class="theme-icon">üåô</span></button>
  </div>
</nav>
<div class="main-container">
  <main class="content" style="margin-left: 0;">
    <article class="doc-article">
      <header class="doc-header">
        <h1>database</h1>
      </header>
      <nav class="toc"><h3>On this page</h3><ul>
        <li style="padding-left: 0px"><a href="#database-wdbx">Database (WDBX)</a></li>
        <li style="padding-left: 16px"><a href="#feature-overview">Feature Overview</a></li>
        <li style="padding-left: 16px"><a href="#usage">Usage</a></li>
        <li style="padding-left: 16px"><a href="#security-backup-restore">Security: Backup & Restore</a></li>
        <li style="padding-left: 16px"><a href="#batch-operations">Batch Operations</a></li>
        <li style="padding-left: 16px"><a href="#full-text-search">Full-Text Search</a></li>
        <li style="padding-left: 16px"><a href="#metadata-filtering">Metadata Filtering</a></li>
        <li style="padding-left: 32px"><a href="#filter-operators">Filter Operators</a></li>
        <li style="padding-left: 16px"><a href="#cli-commands">CLI Commands</a></li>
        <li style="padding-left: 16px"><a href="#new-in-202601">New in 2026.01</a></li>
        <li style="padding-left: 32px"><a href="#diagnostics">Diagnostics</a></li>
        <li style="padding-left: 32px"><a href="#performance-optimizations">Performance Optimizations</a></li>
        <li style="padding-left: 16px"><a href="#api-reference">API Reference</a></li>
        <li style="padding-left: 32px"><a href="#quick-start">Quick Start</a></li>
        <li style="padding-left: 32px"><a href="#diagnosticsinfo-fields">DiagnosticsInfo Fields</a></li>
        <li style="padding-left: 32px"><a href="#memorystats-fields">MemoryStats Fields</a></li>
        <li style="padding-left: 32px"><a href="#thread-safe-operations">Thread-Safe Operations</a></li>
        <li style="padding-left: 32px"><a href="#batch-search">Batch Search</a></li>
        <li style="padding-left: 16px"><a href="#see-also">See Also</a></li>
        <li style="padding-left: 32px"><a href="#related-guides">Related Guides</a></li>
        <li style="padding-left: 32px"><a href="#resources">Resources</a></li>
      </ul></nav>
      <div class="doc-content"><h1 id="database-wdbx">Database (WDBX)<a class="anchor" href="#database-wdbx">#</a></h1>
<blockquote><strong>Codebase Status:</strong> Synced with repository as of 2026-01-23.</blockquote>

<p>&lt;p align=&quot;center&quot;&gt;</p>
<p>  &lt;img src=&quot;https://img.shields.io/badge/Module-Database-orange?style=for-the-badge&amp;logo=mongodb&amp;logoColor=white&quot; alt=&quot;Database Module&quot;/&gt;</p>
<p>  &lt;img src=&quot;https://img.shields.io/badge/Status-Production_Ready-success?style=for-the-badge&quot; alt=&quot;Production Ready&quot;/&gt;</p>
<p>  &lt;img src=&quot;https://img.shields.io/badge/Type-Vector_DB-blue?style=for-the-badge&quot; alt=&quot;Vector DB&quot;/&gt;</p>
<p>&lt;/p&gt;</p>

<p>&lt;p align=&quot;center&quot;&gt;</p>
<p>  &lt;a href=&quot;#usage&quot;&gt;Usage&lt;/a&gt; ‚Ä¢</p>
<p>  &lt;a href=&quot;#batch-operations&quot;&gt;Batch Ops&lt;/a&gt; ‚Ä¢</p>
<p>  &lt;a href=&quot;#full-text-search&quot;&gt;Full-Text&lt;/a&gt; ‚Ä¢</p>
<p>  &lt;a href=&quot;#metadata-filtering&quot;&gt;Filtering&lt;/a&gt; ‚Ä¢</p>
<p>  &lt;a href=&quot;#cli-commands&quot;&gt;CLI&lt;/a&gt;</p>
<p>&lt;/p&gt;</p>

<hr>

<p><strong>WDBX</strong> is ABI's built-in vector database solution, optimized for high-dimensional embedding storage and retrieval.</p>

<h2 id="feature-overview">Feature Overview<a class="anchor" href="#feature-overview">#</a></h2>

<tr><td>Feature</td><td>Description</td><td>Status</td></tr>
<tr><td><strong>Vector Search</strong></td><td>Dot product, Cosine, L2 Euclidean</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>
<tr><td><strong>Zero-Copy</strong></td><td>Zig's memory management</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>
<tr><td><strong>Backup/Restore</strong></td><td>Secure snapshotting</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>
<tr><td><strong>Batch Operations</strong></td><td>High-throughput bulk ops</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>
<tr><td><strong>Full-Text Search</strong></td><td>BM25 ranking</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>
<tr><td><strong>Metadata Filtering</strong></td><td>Rich query operators</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>
<tr><td><strong>Thread Safety</strong></td><td>Concurrent access</td><td>!<a href="https://img.shields.io/badge/-Ready-success">Ready</a></td></tr>

<h2 id="usage">Usage<a class="anchor" href="#usage">#</a></h2>

<pre class="code-block language-zig"><code>const wdbx = abi.wdbx;

var db = try wdbx.createDatabase(allocator, .{ .dimension = 1536 });
defer db.deinit();

// Insert
try db.insertVector(id, embedding_slice);

// Search
const results = try db.searchVectors(query_embedding, 10);
</code></pre>

<h2 id="security-backup-restore">Security: Backup &amp; Restore<a class="anchor" href="#security-backup-restore">#</a></h2>

<blockquote>[!IMPORTANT]</blockquote>
<blockquote><strong>Security Advisory</strong>: Improper path validation in versions prior to 0.2.1 allowed directory traversal.</blockquote>

<p><strong>Safe Practices</strong>:</p>

<p>1.  <strong>Restricted Directory</strong>: All backup/restore operations are confined to the <code>backups/</code> directory.</p>
<p>2.  <strong>Input Validation</strong>: Filenames must <strong>not</strong> contain:</p>
<p>    - Path traversal sequences (<code>..</code>)</p>
<p>    - Absolute paths (<code>/etc/passwd</code>, <code>C:\Windows</code>)</p>
<p>    - Drive letters</p>
<p>3.  <strong>Validation Error</strong>: The API will return <code>PathValidationError</code> if an unsafe path is detected.</p>

<pre class="code-block language-zig"><code>// GOOD
try db.restore(&quot;snapshot_2025.db&quot;);

// BAD (Will fail)
try db.restore(&quot;../../../secret.txt&quot;);
</code></pre>

<h2 id="batch-operations">Batch Operations<a class="anchor" href="#batch-operations">#</a></h2>

<p>Efficient bulk operations for high-throughput scenarios.</p>

<pre class="code-block language-zig"><code>const batch = @import(&quot;abi&quot;).wdbx.batch;

// Configure batch processing
const config = batch.BatchConfig{
    .batch_size = 1000,
    .parallel_workers = 4,
    .retry_failed = true,
    .report_progress = true,
};

// Prepare records
var records = std.ArrayListUnmanaged(batch.BatchRecord){};
defer records.deinit(allocator);

try records.append(allocator, .{
    .id = 1,
    .vector = embedding,
    .metadata = &quot;{\&quot;category\&quot;: \&quot;tech\&quot;}&quot;,
    .text = &quot;Document content for full-text indexing&quot;,
});

// Execute batch insert
const result = try db.batchInsert(records.items, config);
std.debug.print(&quot;Processed: {}, Throughput: {d:.2} items/sec\n&quot;, .{
    result.total_processed,
    result.throughput,
});
</code></pre>

<h2 id="full-text-search">Full-Text Search<a class="anchor" href="#full-text-search">#</a></h2>

<p>BM25-ranked full-text search with configurable tokenization.</p>

<pre class="code-block language-zig"><code>const fulltext = @import(&quot;abi&quot;).wdbx.fulltext;

// Configure BM25 scoring
const bm25_config = fulltext.Bm25Config{
    .k1 = 1.2,          // Term frequency saturation
    .b = 0.75,          // Document length normalization
    .title_boost = 2.0, // Boost title matches
};

// Configure tokenizer
const tokenizer_config = fulltext.TokenizerConfig{
    .lowercase = true,
    .enable_stemming = true,
    .filter_stop_words = true,
    .min_token_length = 2,
};

// Search
const results = try db.textSearch(&quot;machine learning&quot;, .{
    .bm25 = bm25_config,
    .tokenizer = tokenizer_config,
    .max_results = 10,
});
</code></pre>

<h2 id="metadata-filtering">Metadata Filtering<a class="anchor" href="#metadata-filtering">#</a></h2>

<p>Pre-filter and post-filter search with rich operators.</p>

<pre class="code-block language-zig"><code>const filter = @import(&quot;abi&quot;).wdbx.filter;

// Build filter expression
const expr = filter.Filter.init()
    .field(&quot;category&quot;).eq(.{ .string = &quot;tech&quot; })
    .and()
    .field(&quot;year&quot;).gte(.{ .integer = 2023 })
    .and()
    .field(&quot;status&quot;).in_list(.{ .string_list = &amp;.{ &quot;published&quot;, &quot;draft&quot; } });

// Apply filter to vector search
const results = try db.searchVectors(query_embedding, 10, .{
    .filter = expr,
    .filter_strategy = .pre_filter, // or .post_filter
});
</code></pre>

<h3 id="filter-operators">Filter Operators<a class="anchor" href="#filter-operators">#</a></h3>

<tr><td>Operator</td><td>Description</td></tr>
<tr><td><code>eq</code>, <code>ne</code></td><td>Equal / Not equal</td></tr>
<tr><td><code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code></td><td>Numeric comparisons</td></tr>
<tr><td><code>contains</code>, <code>starts_with</code>, <code>ends_with</code></td><td>String matching</td></tr>
<tr><td><code>in_list</code>, <code>not_in_list</code></td><td>List membership</td></tr>
<tr><td><code>exists</code>, <code>not_exists</code></td><td>Field presence</td></tr>
<tr><td><code>regex</code>, <code>between</code></td><td>Pattern / Range matching</td></tr>

<hr>

<h2 id="cli-commands">CLI Commands<a class="anchor" href="#cli-commands">#</a></h2>

<pre class="code-block language-bash"><code># Database operations
zig build run -- db stats                              # Show statistics
zig build run -- db add --id 1 --embed &quot;text&quot;          # Add with embedding
zig build run -- db add --id 2 --vector &quot;1.0,2.0,3.0&quot;  # Add raw vector
zig build run -- db query --text &quot;search term&quot; --k 10  # Search
zig build run -- db optimize                           # Optimize indices

# Backup and restore
zig build run -- db backup --path snapshot.db
zig build run -- db restore --path snapshot.db

# HTTP API server
zig build run -- db serve --port 8080
</code></pre>

<hr>

<h2 id="new-in-202601">New in 2026.01<a class="anchor" href="#new-in-202601">#</a></h2>

<h3 id="diagnostics">Diagnostics<a class="anchor" href="#diagnostics">#</a></h3>

<pre class="code-block language-zig"><code>const diag = db.diagnostics();
if (!diag.isHealthy()) { try db.rebuildNormCache(); }
</code></pre>

<p>Fields: <code>vector_count</code>, <code>dimension</code>, <code>memory.total_bytes</code>, <code>index_health</code>, <code>norm_cache_health</code></p>

<h3 id="performance-optimizations">Performance Optimizations<a class="anchor" href="#performance-optimizations">#</a></h3>

<pre class="code-block language-zig"><code>var db = try database.Database.initWithConfig(allocator, &quot;fast-db&quot;, .{
    .cache_norms = true,       // Pre-computed L2 norms
    .initial_capacity = 10000, // Pre-allocate
    .thread_safe = true,       // Enable concurrent access
});

// O(1) lookup via hash index
const view = db.get(vector_id);

// Thread-safe variants
try db.insertThreadSafe(id, vector, metadata);
const results = try db.searchThreadSafe(allocator, query, top_k);

// Batch search
const all_results = try db.searchBatch(allocator, queries, top_k);
</code></pre>

<hr>

<h2 id="api-reference">API Reference<a class="anchor" href="#api-reference">#</a></h2>

<p><strong>Source:</strong> <code>src/database/mod.zig</code></p>

<h3 id="quick-start">Quick Start<a class="anchor" href="#quick-start">#</a></h3>

<pre class="code-block language-zig"><code>const database = @import(&quot;src/database/database.zig&quot;);

// Create a database with configuration
var db = try database.Database.initWithConfig(allocator, &quot;my-vectors&quot;, .{
    .cache_norms = true,
    .initial_capacity = 1000,
    .thread_safe = true,
});
defer db.deinit();

// Insert vectors
try db.insert(1, &amp;[_]f32{ 1.0, 0.0, 0.0 }, &quot;metadata&quot;);
try db.insert(2, &amp;[_]f32{ 0.0, 1.0, 0.0 }, null);

// Search for similar vectors
const results = try db.search(allocator, &amp;[_]f32{ 0.9, 0.1, 0.0 }, 5);
defer allocator.free(results);

for (results) |result| {
    std.log.info(&quot;ID: {d}, Score: {d:.4}&quot;, .{ result.id, result.score });
}
</code></pre>

<h3 id="diagnosticsinfo-fields">DiagnosticsInfo Fields<a class="anchor" href="#diagnosticsinfo-fields">#</a></h3>

<tr><td>Field</td><td>Type</td><td>Description</td></tr>
<tr><td><code>name</code></td><td><code>[]const u8</code></td><td>Database name</td></tr>
<tr><td><code>vector_count</code></td><td><code>usize</code></td><td>Number of stored vectors</td></tr>
<tr><td><code>dimension</code></td><td><code>usize</code></td><td>Vector dimension</td></tr>
<tr><td><code>memory</code></td><td><code>MemoryStats</code></td><td>Memory usage breakdown</td></tr>
<tr><td><code>config</code></td><td><code>ConfigStatus</code></td><td>Configuration status</td></tr>
<tr><td><code>index_health</code></td><td><code>f32</code></td><td>Index integrity (1.0 = healthy)</td></tr>
<tr><td><code>norm_cache_health</code></td><td><code>f32</code></td><td>Norm cache integrity (1.0 = healthy)</td></tr>

<h3 id="memorystats-fields">MemoryStats Fields<a class="anchor" href="#memorystats-fields">#</a></h3>

<tr><td>Field</td><td>Type</td><td>Description</td></tr>
<tr><td><code>vector_bytes</code></td><td><code>usize</code></td><td>Memory for vector data</td></tr>
<tr><td><code>norm_cache_bytes</code></td><td><code>usize</code></td><td>Memory for norm cache</td></tr>
<tr><td><code>metadata_bytes</code></td><td><code>usize</code></td><td>Memory for metadata</td></tr>
<tr><td><code>index_bytes</code></td><td><code>usize</code></td><td>Memory for index structures</td></tr>
<tr><td><code>total_bytes</code></td><td><code>usize</code></td><td>Total memory footprint</td></tr>
<tr><td><code>efficiency</code></td><td><code>f32</code></td><td>Data bytes / total bytes ratio</td></tr>

<h3 id="thread-safe-operations">Thread-Safe Operations<a class="anchor" href="#thread-safe-operations">#</a></h3>

<p>When <code>thread_safe</code> is enabled in config:</p>

<pre class="code-block language-zig"><code>// Thread-safe variants automatically acquire locks
try db.insertThreadSafe(id, vector, metadata);
const view = db.getThreadSafe(id);
const results = try db.searchThreadSafe(allocator, query, top_k);
_ = db.deleteThreadSafe(id);
</code></pre>

<h3 id="batch-search">Batch Search<a class="anchor" href="#batch-search">#</a></h3>

<p>Search multiple queries efficiently:</p>

<pre class="code-block language-zig"><code>const queries = &amp;[_][]const f32{
    &amp;[_]f32{ 1.0, 0.0, 0.0 },
    &amp;[_]f32{ 0.0, 1.0, 0.0 },
};

const all_results = try db.searchBatch(allocator, queries, 5);
defer {
    for (all_results) |res| allocator.free(res);
    allocator.free(all_results);
}
</code></pre>

<hr>

<h2 id="see-also">See Also<a class="anchor" href="#see-also">#</a></h2>

<p>&lt;table&gt;</p>
<p>&lt;tr&gt;</p>
<p>&lt;td&gt;</p>

<h3 id="related-guides">Related Guides<a class="anchor" href="#related-guides">#</a></h3>
<li><a href="ai.md">AI &amp; Agents</a> ‚Äî Embedding generation for vectors</li>
<li><a href="gpu.md">GPU Acceleration</a> ‚Äî GPU-accelerated search</li>
<li><a href="monitoring.md">Monitoring</a> ‚Äî Database metrics</li>
<li><a href="research/abbey-aviva-abi-wdbx-framework.md">Abbey-Aviva Research</a> ‚Äî WDBX architecture design</li>

<p>&lt;/td&gt;</p>
<p>&lt;td&gt;</p>

<h3 id="resources">Resources<a class="anchor" href="#resources">#</a></h3>
<li><a href="troubleshooting.md">Troubleshooting</a> ‚Äî Path validation and issues</li>
<li><a href="../API_REFERENCE.md">API Reference</a> ‚Äî Database API details</li>
<li><a href="../examples/">Examples</a> ‚Äî Database code samples</li>

<p>&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;/table&gt;</p>

<hr>

<p>&lt;p align=&quot;center&quot;&gt;</p>
<p>  &lt;a href=&quot;gpu.md&quot;&gt;‚Üê GPU Guide&lt;/a&gt; ‚Ä¢</p>
<p>  &lt;a href=&quot;docs-index.md&quot;&gt;Documentation Index&lt;/a&gt; ‚Ä¢</p>
<p>  &lt;a href=&quot;network.md&quot;&gt;Network Guide ‚Üí&lt;/a&gt;</p>
<p>&lt;/p&gt;</p>

</div>
    </article>
  </main>
</div>
<footer class="footer" style="margin-left: 0;">
  <div class="footer-content">
    <div class="footer-section">
      <h4>ABI Framework</h4>
      <p>Modern Zig framework for AI services and high-performance systems.</p>
    </div>
  </div>
  <div class="footer-bottom"><p>&copy; 2026 ABI Framework. Built with Zig.</p></div>
</footer>
<script src="/abi/assets/js/main.js"></script>
</body>
</html>
