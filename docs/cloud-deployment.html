<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cloud Deployment Guide - ABI Framework Documentation</title>
  <meta name="description" content="Deploy ABI applications as serverless functions on AWS Lambda, Google Cloud Functions, and Azure Functions">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/abi/assets/css/style.css">
</head>
<body>
<nav class="navbar">
  <div class="nav-container">
    <a href="/abi/" class="nav-logo">
      <span class="logo-text">ABI</span>
      <span class="logo-version">v0.16.0</span>
    </a>
    <div class="nav-links">
      <a href="/abi/">Home</a>
      <a href="/abi/intro.html">Docs</a>
      <a href="https://github.com/donaldfilimon/abi" target="_blank">GitHub</a>
    </div>
    <button class="theme-toggle" onclick="toggleTheme()"><span class="theme-icon">ðŸŒ™</span></button>
  </div>
</nav>
<div class="main-container">
  <main class="content" style="margin-left: 0;">
    <article class="doc-article">
      <header class="doc-header">
        <h1>Cloud Deployment Guide</h1>
        <p class="doc-description">Deploy ABI applications as serverless functions on AWS Lambda, Google Cloud Functions, and Azure Functions</p>
      </header>
      <nav class="toc"><h3>On this page</h3><ul>
        <li style="padding-left: 0px"><a href="#cloud-deployment-guide">Cloud Deployment Guide</a></li>
        <li style="padding-left: 16px"><a href="#overview">Overview</a></li>
        <li style="padding-left: 16px"><a href="#quick-start">Quick Start</a></li>
        <li style="padding-left: 32px"><a href="#1-write-your-handler">1. Write Your Handler</a></li>
        <li style="padding-left: 32px"><a href="#2-build-for-your-target-platform">2. Build for Your Target Platform</a></li>
        <li style="padding-left: 32px"><a href="#3-deploy">3. Deploy</a></li>
        <li style="padding-left: 16px"><a href="#aws-lambda">AWS Lambda</a></li>
        <li style="padding-left: 32px"><a href="#prerequisites">Prerequisites</a></li>
        <li style="padding-left: 32px"><a href="#deployment-with-sam">Deployment with SAM</a></li>
        <li style="padding-left: 32px"><a href="#sam-template-structure">SAM Template Structure</a></li>
        <li style="padding-left: 32px"><a href="#environment-variables">Environment Variables</a></li>
        <li style="padding-left: 32px"><a href="#event-parsing">Event Parsing</a></li>
        <li style="padding-left: 16px"><a href="#google-cloud-functions">Google Cloud Functions</a></li>
        <li style="padding-left: 32px"><a href="#prerequisites">Prerequisites</a></li>
        <li style="padding-left: 32px"><a href="#deployment">Deployment</a></li>
        <li style="padding-left: 32px"><a href="#configuration-options">Configuration Options</a></li>
        <li style="padding-left: 32px"><a href="#environment-variables">Environment Variables</a></li>
        <li style="padding-left: 32px"><a href="#event-parsing">Event Parsing</a></li>
        <li style="padding-left: 16px"><a href="#azure-functions">Azure Functions</a></li>
        <li style="padding-left: 32px"><a href="#prerequisites">Prerequisites</a></li>
        <li style="padding-left: 32px"><a href="#deployment">Deployment</a></li>
        <li style="padding-left: 32px"><a href="#configuration-files">Configuration Files</a></li>
        <li style="padding-left: 32px"><a href="#environment-variables">Environment Variables</a></li>
        <li style="padding-left: 32px"><a href="#event-parsing">Event Parsing</a></li>
        <li style="padding-left: 16px"><a href="#advanced-usage">Advanced Usage</a></li>
        <li style="padding-left: 32px"><a href="#response-builder">Response Builder</a></li>
        <li style="padding-left: 32px"><a href="#error-handling">Error Handling</a></li>
        <li style="padding-left: 32px"><a href="#provider-detection">Provider Detection</a></li>
        <li style="padding-left: 32px"><a href="#framework-integration">Framework Integration</a></li>
        <li style="padding-left: 16px"><a href="#configuration-reference">Configuration Reference</a></li>
        <li style="padding-left: 32px"><a href="#cloudconfig">CloudConfig</a></li>
        <li style="padding-left: 32px"><a href="#cors-configuration">CORS Configuration</a></li>
        <li style="padding-left: 16px"><a href="#troubleshooting">Troubleshooting</a></li>
        <li style="padding-left: 32px"><a href="#common-issues">Common Issues</a></li>
        <li style="padding-left: 32px"><a href="#logging">Logging</a></li>
        <li style="padding-left: 16px"><a href="#best-practices">Best Practices</a></li>
        <li style="padding-left: 16px"><a href="#see-also">See Also</a></li>
      </ul></nav>
      <div class="doc-content">
<h1 id="cloud-deployment-guide">Cloud Deployment Guide<a class="anchor" href="#cloud-deployment-guide">#</a></h1>

<p>The ABI framework provides unified cloud function adapters for deploying your applications as serverless functions across major cloud providers. This guide covers deployment to AWS Lambda, Google Cloud Functions, and Azure Functions.</p>

<h2 id="overview">Overview<a class="anchor" href="#overview">#</a></h2>

<p>The cloud module (<code>src/cloud/</code>) provides:</p>

<li><strong>Unified Event Model</strong>: A common <code>CloudEvent</code> struct that normalizes incoming events across all providers</li>
<li><strong>Unified Response Model</strong>: A common <code>CloudResponse</code> struct for consistent response handling</li>
<li><strong>Provider-Specific Adapters</strong>: Optimized parsing and formatting for each cloud provider</li>
<li><strong>Context Extraction</strong>: Access to provider-specific context and metadata</li>
<li><strong>Auto-Detection</strong>: Automatic provider detection based on environment variables</li>

<h2 id="quick-start">Quick Start<a class="anchor" href="#quick-start">#</a></h2>

<h3 id="1-write-your-handler">1. Write Your Handler<a class="anchor" href="#1-write-your-handler">#</a></h3>

<p>Create a handler function that works on all providers:</p>

<pre class="code-block language-zig"><code>const std = @import(&quot;std&quot;);
const abi = @import(&quot;abi&quot;);
const cloud = abi.cloud;

/// Your function handler - same code works on all providers
fn handler(event: *cloud.CloudEvent, allocator: std.mem.Allocator) !cloud.CloudResponse {
    // Access request data uniformly
    const method = if (event.method) |m| m.toString() else &quot;N/A&quot;;
    const path = event.path orelse &quot;/&quot;;
    const body = event.body orelse &quot;{}&quot;;

    // Log the request
    std.log.info(&quot;Request: {s} {s}&quot;, .{method, path});

    // Process the request
    var response_body = std.ArrayList(u8).init(allocator);
    defer response_body.deinit();

    try std.json.stringify(.{
        .message = &quot;Hello from the cloud!&quot;,
        .provider = event.provider.name(),
        .request_id = event.request_id,
    }, .{}, response_body.writer());

    // Return a JSON response
    return try cloud.CloudResponse.json(allocator, try response_body.toOwnedSlice());
}

pub fn main() !void {
    var gpa = std.heap.GeneralPurposeAllocator(.{}){};
    defer _ = gpa.deinit();
    const allocator = gpa.allocator();

    // Auto-detect provider and run
    try cloud.runHandler(allocator, handler);
}
</code></pre>

<h3 id="2-build-for-your-target-platform">2. Build for Your Target Platform<a class="anchor" href="#2-build-for-your-target-platform">#</a></h3>

<pre class="code-block language-bash"><code># For AWS Lambda (x86_64 Linux)
zig build -Dtarget=x86_64-linux-gnu -Doptimize=ReleaseFast

# For AWS Lambda (ARM64 Linux - recommended for cost)
zig build -Dtarget=aarch64-linux-gnu -Doptimize=ReleaseFast

# For GCP Cloud Functions (x86_64 Linux)
zig build -Dtarget=x86_64-linux-gnu -Doptimize=ReleaseFast

# For Azure Functions (depends on your Function App plan)
zig build -Dtarget=x86_64-linux-gnu -Doptimize=ReleaseFast
</code></pre>

<h3 id="3-deploy">3. Deploy<a class="anchor" href="#3-deploy">#</a></h3>

<p>See provider-specific sections below for deployment instructions.</p>

<h2 id="aws-lambda">AWS Lambda<a class="anchor" href="#aws-lambda">#</a></h2>

<h3 id="prerequisites">Prerequisites<a class="anchor" href="#prerequisites">#</a></h3>

<li>AWS CLI configured with appropriate credentials</li>
<li>AWS SAM CLI installed</li>
<li>IAM permissions for Lambda, API Gateway, CloudWatch Logs</li>

<h3 id="deployment-with-sam">Deployment with SAM<a class="anchor" href="#deployment-with-sam">#</a></h3>

<p>1. Navigate to the deployment directory:</p>

<pre class="code-block language-bash"><code>cd deploy/aws
</code></pre>

<p>2. Build and deploy:</p>

<pre class="code-block language-bash"><code>sam build &amp;&amp; sam deploy --guided
</code></pre>

<p>3. Follow the prompts to configure your deployment.</p>

<h3 id="sam-template-structure">SAM Template Structure<a class="anchor" href="#sam-template-structure">#</a></h3>

<p>The <code>template.yaml</code> includes:</p>

<li><strong>HttpFunction</strong>: HTTP API Gateway triggered function</li>
<li><strong>QueueFunction</strong>: SQS triggered function</li>
<li><strong>ScheduledFunction</strong>: CloudWatch Events (cron) triggered function</li>

<h3 id="environment-variables">Environment Variables<a class="anchor" href="#environment-variables">#</a></h3>

<tr><td>Variable</td><td>Description</td></tr>
<tr><td><code>AWS_LAMBDA_RUNTIME_API</code></td><td>Runtime API endpoint (set by Lambda)</td></tr>
<tr><td><code>AWS_LAMBDA_FUNCTION_NAME</code></td><td>Function name (set by Lambda)</td></tr>
<tr><td><code>LOG_LEVEL</code></td><td>Logging level (debug, info, warn, error)</td></tr>
<tr><td><code>ABI_CLOUD_PROVIDER</code></td><td>Set to <code>aws_lambda</code></td></tr>

<h3 id="event-parsing">Event Parsing<a class="anchor" href="#event-parsing">#</a></h3>

<p>The AWS adapter handles:</p>

<li>API Gateway REST API events (v1)</li>
<li>API Gateway HTTP API events (v2)</li>
<li>SQS events</li>
<li>SNS events</li>
<li>S3 events</li>
<li>CloudWatch Events</li>

<pre class="code-block language-zig"><code>// Access AWS-specific context
const function_arn = event.context.function_arn;
const remaining_time = event.context.remaining_time_ms;
</code></pre>

<h2 id="google-cloud-functions">Google Cloud Functions<a class="anchor" href="#google-cloud-functions">#</a></h2>

<h3 id="prerequisites">Prerequisites<a class="anchor" href="#prerequisites">#</a></h3>

<li>Google Cloud SDK installed</li>
<li>GCP project configured</li>
<li>Cloud Functions API enabled</li>

<h3 id="deployment">Deployment<a class="anchor" href="#deployment">#</a></h3>

<p>1. Build for Linux:</p>

<pre class="code-block language-bash"><code>zig build -Dtarget=x86_64-linux-gnu -Doptimize=ReleaseFast
</code></pre>

<p>2. Deploy with gcloud:</p>

<pre class="code-block language-bash"><code>gcloud functions deploy abi-function \
  --gen2 \
  --runtime=provided \
  --region=us-central1 \
  --source=./zig-out/bin \
  --entry-point=handler \
  --trigger-http \
  --allow-unauthenticated
</code></pre>

<h3 id="configuration-options">Configuration Options<a class="anchor" href="#configuration-options">#</a></h3>

<p>See <code>deploy/gcp/cloudfunctions.yaml</code> for full configuration options including:</p>

<li>HTTP triggers</li>
<li>Pub/Sub triggers</li>
<li>Cloud Storage triggers</li>
<li>Firestore triggers</li>

<h3 id="environment-variables">Environment Variables<a class="anchor" href="#environment-variables">#</a></h3>

<tr><td>Variable</td><td>Description</td></tr>
<tr><td><code>K_SERVICE</code></td><td>Service name (set by Cloud Run)</td></tr>
<tr><td><code>FUNCTION_NAME</code></td><td>Function name (legacy)</td></tr>
<tr><td><code>PORT</code></td><td>HTTP server port (set by runtime)</td></tr>
<tr><td><code>GCP_PROJECT</code></td><td>GCP project ID</td></tr>
<tr><td><code>FUNCTION_REGION</code></td><td>Deployment region</td></tr>

<h3 id="event-parsing">Event Parsing<a class="anchor" href="#event-parsing">#</a></h3>

<p>The GCP adapter handles:</p>

<li>HTTP requests</li>
<li>CloudEvents (structured)</li>
<li>Pub/Sub messages</li>
<li>Cloud Storage events</li>

<pre class="code-block language-zig"><code>// Access GCP-specific context
const project_id = event.context.project_id;
const region = event.context.region;
</code></pre>

<h2 id="azure-functions">Azure Functions<a class="anchor" href="#azure-functions">#</a></h2>

<h3 id="prerequisites">Prerequisites<a class="anchor" href="#prerequisites">#</a></h3>

<li>Azure CLI installed</li>
<li>Azure Functions Core Tools installed</li>
<li>Azure subscription configured</li>

<h3 id="deployment">Deployment<a class="anchor" href="#deployment">#</a></h3>

<p>1. Build for your target platform:</p>

<pre class="code-block language-bash"><code>zig build -Dtarget=x86_64-linux-gnu -Doptimize=ReleaseFast
</code></pre>

<p>2. Deploy with Azure CLI:</p>

<pre class="code-block language-bash"><code># Create a Function App (if not exists)
az functionapp create \
  --resource-group myResourceGroup \
  --consumption-plan-location westus \
  --runtime custom \
  --functions-version 4 \
  --name abi-function-app \
  --storage-account mystorageaccount

# Deploy
func azure functionapp publish abi-function-app
</code></pre>

<h3 id="configuration-files">Configuration Files<a class="anchor" href="#configuration-files">#</a></h3>

<li><code>function.json</code>: Trigger and binding configuration</li>
<li><code>host.json</code>: Host-level configuration</li>
<li><code>local.settings.json</code>: Local development settings</li>

<h3 id="environment-variables">Environment Variables<a class="anchor" href="#environment-variables">#</a></h3>

<tr><td>Variable</td><td>Description</td></tr>
<tr><td><code>FUNCTIONS_HTTPWORKER_PORT</code></td><td>Custom handler port</td></tr>
<tr><td><code>FUNCTION_NAME</code></td><td>Function name</td></tr>
<tr><td><code>WEBSITE_SITE_NAME</code></td><td>App Service name</td></tr>
<tr><td><code>AZURE_FUNCTIONS_ENVIRONMENT</code></td><td>Environment (Development, Production)</td></tr>

<h3 id="event-parsing">Event Parsing<a class="anchor" href="#event-parsing">#</a></h3>

<p>The Azure adapter handles:</p>

<li>HTTP triggers</li>
<li>Timer triggers</li>
<li>Blob Storage triggers</li>
<li>Queue triggers</li>
<li>Event Hub triggers</li>
<li>Service Bus triggers</li>

<pre class="code-block language-zig"><code>// Access Azure-specific context
const invocation_id = event.context.invocation_id;
const function_name = event.context.function_name;
</code></pre>

<h2 id="advanced-usage">Advanced Usage<a class="anchor" href="#advanced-usage">#</a></h2>

<h3 id="response-builder">Response Builder<a class="anchor" href="#response-builder">#</a></h3>

<p>Use the fluent response builder for complex responses:</p>

<pre class="code-block language-zig"><code>var response = cloud.ResponseBuilder.init(allocator)
    .status(201)
    .json()
    .header(&quot;X-Custom-Header&quot;, &quot;value&quot;)
    .cors(&quot;*&quot;)
    .body(&quot;{\&quot;created\&quot;:true}&quot;)
    .build();
</code></pre>

<h3 id="error-handling">Error Handling<a class="anchor" href="#error-handling">#</a></h3>

<p>Return structured error responses:</p>

<pre class="code-block language-zig"><code>fn handler(event: *cloud.CloudEvent, allocator: std.mem.Allocator) !cloud.CloudResponse {
    // Validate request
    if (event.body == null) {
        return cloud.CloudResponse.err(allocator, 400, &quot;Request body is required&quot;);
    }

    // Process or return error
    processRequest(event) catch |err| {
        return cloud.CloudResponse.err(allocator, 500, @errorName(err));
    };

    return cloud.CloudResponse.json(allocator, &quot;{\&quot;success\&quot;:true}&quot;);
}
</code></pre>

<h3 id="provider-detection">Provider Detection<a class="anchor" href="#provider-detection">#</a></h3>

<p>Detect the current provider at runtime:</p>

<pre class="code-block language-zig"><code>const provider = cloud.detectProvider();
if (provider) |p| {
    std.log.info(&quot;Running on {s}&quot;, .{p.name()});
} else {
    std.log.info(&quot;Not running in a cloud environment&quot;);
}
</code></pre>

<h3 id="framework-integration">Framework Integration<a class="anchor" href="#framework-integration">#</a></h3>

<p>Use the cloud module with the full ABI framework:</p>

<pre class="code-block language-zig"><code>const abi = @import(&quot;abi&quot;);

fn handler(event: *abi.cloud.CloudEvent, allocator: std.mem.Allocator) !abi.cloud.CloudResponse {
    // Initialize framework for this request
    var fw = try abi.initDefault(allocator);
    defer fw.deinit();

    // Use framework features
    if (fw.isEnabled(.ai)) {
        // Use AI features
    }

    if (fw.isEnabled(.database)) {
        // Use database features
    }

    return abi.cloud.CloudResponse.json(allocator, &quot;{\&quot;ok\&quot;:true}&quot;);
}
</code></pre>

<h2 id="configuration-reference">Configuration Reference<a class="anchor" href="#configuration-reference">#</a></h2>

<h3 id="cloudconfig">CloudConfig<a class="anchor" href="#cloudconfig">#</a></h3>

<pre class="code-block language-zig"><code>const config = abi.cloud.CloudConfig{
    .memory_mb = 512,
    .timeout_seconds = 30,
    .tracing_enabled = true,
    .logging_enabled = true,
    .log_level = .info,
    .cors = .{
        .allowed_origins = &amp;.{&quot;https://example.com&quot;},
        .allowed_methods = &amp;.{ .GET, .POST },
    },
};
</code></pre>

<h3 id="cors-configuration">CORS Configuration<a class="anchor" href="#cors-configuration">#</a></h3>

<p>Enable CORS for HTTP functions:</p>

<pre class="code-block language-zig"><code>.cors = .{
    .allowed_origins = &amp;.{&quot;*&quot;},
    .allowed_methods = &amp;.{ .GET, .POST, .PUT, .DELETE, .OPTIONS },
    .allowed_headers = &amp;.{ &quot;Content-Type&quot;, &quot;Authorization&quot; },
    .max_age_seconds = 86400,
    .allow_credentials = false,
},
</code></pre>

<h2 id="troubleshooting">Troubleshooting<a class="anchor" href="#troubleshooting">#</a></h2>

<h3 id="common-issues">Common Issues<a class="anchor" href="#common-issues">#</a></h3>

<p><strong>Function times out</strong></p>
<li>Increase the timeout in your deployment configuration</li>
<li>Check for blocking operations or infinite loops</li>
<li>Ensure database connections are properly managed</li>

<p><strong>Cold start latency</strong></p>
<li>Use provisioned concurrency (AWS) or minimum instances (GCP)</li>
<li>Reduce function size by disabling unused features</li>
<li>Use ARM64 architecture on AWS for faster cold starts</li>

<p><strong>Memory errors</strong></p>
<li>Increase memory allocation</li>
<li>Check for memory leaks in your handler</li>
<li>Use <code>GeneralPurposeAllocator</code> with leak detection in debug builds</li>

<p><strong>Permission denied</strong></p>
<li>Verify IAM roles/service accounts have required permissions</li>
<li>Check VPC configuration if accessing private resources</li>

<h3 id="logging">Logging<a class="anchor" href="#logging">#</a></h3>

<p>Enable debug logging for troubleshooting:</p>

<pre class="code-block language-bash"><code># Environment variable
LOG_LEVEL=debug
</code></pre>

<p>View logs:</p>

<pre class="code-block language-bash"><code># AWS
aws logs tail /aws/lambda/abi-function --follow

# GCP
gcloud functions logs read abi-function

# Azure
func azure functionapp logstream abi-function-app
</code></pre>

<h2 id="best-practices">Best Practices<a class="anchor" href="#best-practices">#</a></h2>

<p>1. <strong>Keep handlers small</strong>: Focus on request handling, delegate business logic</p>
<p>2. <strong>Use connection pooling</strong>: Reuse database connections across invocations</p>
<p>3. <strong>Handle cold starts</strong>: Initialize expensive resources outside the handler</p>
<p>4. <strong>Set appropriate timeouts</strong>: Match timeout to expected execution time</p>
<p>5. <strong>Use structured logging</strong>: Include request IDs for tracing</p>
<p>6. <strong>Implement retries</strong>: Handle transient failures gracefully</p>
<p>7. <strong>Validate inputs</strong>: Check request data before processing</p>
<p>8. <strong>Return appropriate status codes</strong>: Use HTTP semantics correctly</p>

<h2 id="see-also">See Also<a class="anchor" href="#see-also">#</a></h2>

<li><a href="api/index.md">API Reference</a> - Full API documentation</li>
<li><a href="architecture/overview.md">Architecture Overview</a> - System architecture</li>
<li><a href="troubleshooting.md">Troubleshooting</a> - Common issues and solutions</li>
</div>
    </article>
  </main>
</div>
<footer class="footer" style="margin-left: 0;">
  <div class="footer-content">
    <div class="footer-section">
      <h4>ABI Framework</h4>
      <p>Modern Zig framework for AI services and high-performance systems.</p>
    </div>
  </div>
  <div class="footer-bottom"><p>&copy; 2026 ABI Framework. Built with Zig.</p></div>
</footer>
<script src="/abi/assets/js/main.js"></script>
</body>
</html>
